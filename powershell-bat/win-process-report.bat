@echo off
powershell.exe -ExecutionPolicy Bypass -NoExit -Command "Add-Type -AssemblyName System.Windows.Forms; $downloads = [System.IO.Path]::Combine($env:USERPROFILE, 'Downloads'); $dialog = New-Object System.Windows.Forms.SaveFileDialog; $dialog.InitialDirectory = $downloads; $dialog.Filter = 'CSV files (*.csv)|*.csv'; $dialog.Title = 'Save Process Report As'; $dialog.FileName = 'process_report.csv'; if ($dialog.ShowDialog() -eq 'OK') { Get-Process | Select-Object Id, ProcessName, CPU, @{Name='Memory (MB)'; Expression={[math]::Round($_.WS / 1MB, 2)}} | Export-Csv -Path $dialog.FileName -NoTypeInformation; Write-Host ''; Write-Host 'Report saved to:' $dialog.FileName; } else { Write-Host ''; Write-Host 'Report creation was cancelled.' }; Write-Host ''; Read-Host 'Press Enter to close this window.'"
